<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>Bulk Order</title>
		<!-- <link rel="stylesheet" type="text/css" href="css/bootstrap.css"> -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
		<link type="text/css" rel="stylesheet" href="https://docs.handsontable.com/pro/1.7.0/bower_components/handsontable-pro/dist/handsontable.full.min.css">
		<link rel="stylesheet" href="css/custom-style.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<style type="text/css">
			.affix{
				top:0px;
				width:100%;
				z-index: 999999;
			}

			.ht_clone_top, .ht_clone_top_left_corner{
				top:148px !important;
				display: none;
				/*position: fixed !important;*/
			}
		</style>
	</head>
	<body>

		<div class="jumbotron" style="padding:20px 0 10px 0; margin-bottom:0px; background-color: #0e5aa8;">
			<div class="container">
				<a href="#"><img src="https://cdn.shopify.com/s/files/1/1431/0294/t/3/assets/logo.png?16214878102389155724" style="max-width:115px; width:100%;"></a>
			</div>	
		</div>
		<div id="nav-wrapper" data-spy="affix" data-offset-top="150">
		<div class="container-fluid theme-color" style="border-top: 1px solid #1067c0; background-color: #0e5aa8; height:58px;">
					&nbsp;
		</div>

		<nav id="navbar" class="navbar navbar-default">
		<div class="container-fluid">
			<h6>&nbsp;</h6>
			<div class="row">
				<!-- <div class="col-md-2 col-sm-2 col-xs-2">
					<a class="disabled" style="font-size:20px; text-decoration:none !important;">Ship to Location</a>	
				</div> -->
				<div class="col-md-1 col-sm-1 col-xs-1">
					<a href="index.php" class="text-green">Locations</a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1" style="max-width:60px;">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<a href="product.html" class="text-green">Products</a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1" style="max-width:60px;">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2">
					<!-- <div class="select-wrapper"> -->
						<select class="form-control text-center" style="font-size:13px; height:30px;">
							<option disabled selected>Shipping Class</option>
							<option>option 1</option>
							<option>option 2</option>
							<option>option 3</option>
						</select>
						<!-- <div class="next-icon" style=""><i class="fa fa-caret-down"></i></div> -->
					<!-- </div>	 -->
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1" style="max-width:60px;">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2">
					<a href="javascript:;" class="disabled">Product Allocation</a>	
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2 pull-right">
					<a href="#" class="btn btn-success pull-right">Clear Bulk Order</a>	
				</div>
			</div>
			<hr class="hr-full">
		</div>
	</nav>
	</div>
		<div class="container">
			<!-- <br>
			<h1>&nbsp;</h1> -->
			
			<h2 id="fix">Shipping</h2>
			<hr>
			
			 <div id="datasheet" class="hot handsontable htRowHeaders htColumnHeaders" style=""></div> 
			  
			<h4>&nbsp;</h4>
			<div class="row">
		  		<div class="col-md-2 col-sm-3 col-xs-6">
		  			<button id="export-string" type="button" class="btn gray-bg intext-btn">SAVE CHANGES</button>		
		  		</div>
		  		<div class="col-md-3 col-sm-4 col-xs-6">
		  			<button class="btn gray-bg" data-toggle="collapse" data-target="#csv-upload">UPLOAD SHIPMENT FILE</button>		
		  		</div>
		  		<div class="col-md-2 col-sm-3 col-xs-6">
		  			<a href="#" class="btn btn-primary">Next Page&nbsp;&nbsp;<i class="fa fa-caret-right"></i></a>		
		  		</div>
		  </div>

			<h2>&nbsp;</h2>

			<div id="csv-upload" class="collapse">
			  	<div class="form-group">
			    	<div class="col-md-12">
			    		<div class="col-md-4">
				    		<label for="concentrations"><strong>Bulk Location file Upload</strong></label>
		    				<input type="text" class="form-control" id="csv_upload_txt" disabled placeholder="No file Selected...">
				    		<span class="w3-tiny pull-right">(Supported format: csv, xls, xlsx)</span>
				    		<h6></h6>
				      	</div>
				      	<div class="col-md-2 col-sm-3 col-xs-4">
				      		<p style="font-size:1px;">&nbsp;</p>
				      		<input id="csv_upload" type="file" class="form-control" name="csv_upload" accept=".csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" style="opacity:0; height:0px;">
				      		<input type="button" class="form-control" id="" value="Upload" onclick="this.previousElementSibling.click();" style="display:inline;">
				      	</div>
			    	</div>
				</div>
			</div>
		</div>
		<h2>&nbsp;</h2>
		<div class="jumbotron" style="padding:20px 50px 10px 50px; margin-bottom:0px; background-color: #0e5aa8;">
			<div class="container" style="height:150px;">
				<!-- <img src="https://cdn.shopify.com/s/files/1/1431/0294/t/3/assets/logo.png?16214878102389155724" style="max-width:115px; width:100%;"> -->
			</div>	
		</div>
		<div class="container-fluid theme-color" style="border-top: 1px solid #1067c0; background-color: #0e5aa8;">
			<div class="container" style="border-top: 1px solid white; padding:10px 50px;color: rgba(255, 255, 255, 0.6);">
				<small>
					&copy; 2016
					<a href="/" style="color:white;" title="">ShopWaterPlus</a>
				</small>
			</div>
		</div>
		<!-- // <script type="text/javascript" src="js/bootstrap.js"></script> -->
		<script src="https://docs.handsontable.com/pro/1.7.0/bower_components/handsontable-pro/dist/handsontable.full.min.js"></script>
		<script type="text/javascript" src="js/papaparse.min.js"></script>
		<script type="text/javascript">

			$(document).ready(function(){
				$("#nav-wrapper").on('affix.bs.affix', function(){
					$('.ht_clone_top, .ht_clone_top_left_corner').css('display','block');
				});

				$("#nav-wrapper").on('affix-top.bs.affix', function(){
					$('.ht_clone_top, .ht_clone_top_left_corner').css('display','none');
				});		
			});

			document.addEventListener("DOMContentLoaded", function() {

				

				// var myData = getJSONdata();

				function getJSONdata() {
				// 	var fetchedData = [];
				// 	$.getJSON('json/shippingBlank.json', function(data) {
				// 	    fetchedData = JSON.parse(data);
				// 	});

				// 	return fetchedData;

					// $.ajax({
					//     url: "json/myData.js",
					//     async: false,
					//     success: function (csvd) {
					//         // data = $.csv.toArrays(csvd);
					//         return csvd;
					//     },
					//     dataType: "script",
					//     complete: function () {
					//         // call a function on complete 
					//         // alert('data loaded');

					//     }
					// });
					
					// else
					return  [
								{ Ship_To_State : 'AL', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'AK', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'AZ', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'AK', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'CA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'CO', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'CT', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'DE', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'FL', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'GA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'HI', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'ID', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'IL', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'IN', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'IO', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'KA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'KE', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'LO', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'ME', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MD', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MI', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MN', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MS', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MO', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'MT', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NE', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NV', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NH', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NJ', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NM', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NY', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NC', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'ND', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'OH', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'OK', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'OR', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'PA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'RI', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'SC', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'SD', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'TN', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'TX', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'UT', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'VE', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'VA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'WA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'DC', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'WV', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'WI', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'WY', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'J', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'C', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'BCVZB', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'A', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'A', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'M', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NSBKM', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NBEAA', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'M', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'PEICAB', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'NTXAE', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'A', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' },
								{ Ship_To_State : 'H', 150 : '', 200 : '', 250 : '', 300 : '', 350 : '', 400 : '', 450 : '', 500 : '', 550 : '', 600 : '', 650 : '', 700 : '', 750 : '', 800 : '', 850 : '', 900 : '', 950 : '', 1000 : '', 1050 : '', 1100 : '', 1150 : '', 1200 : '', 1250 : '', 1300 : '', 1350 : '', 1400 : '', 1450 : '', 1500 : '' }
							];

				}


			    var datasheet = document.getElementById('datasheet');

				var hot = new Handsontable(datasheet, {
														data: getJSONdata(),
													    startRows: 29,
													    startCols: 65,
													    colHeaders: ['Ship To State','150','200','250','300','350','400','450','500','550','600','650','700','750','800','850','900','950','1000','1050','1100','1150','1200','1250','1300','1350','1400','1450','1500'],
													    rowHeaders: true,
													    preventOverflow: 'horizontal',
													    observeChanges: true,
													    className: "htRight",
													    fixedColumnsLeft: 1,
													    colWidths: ['150','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100','100', '100'],
													    validator: /(\$[\d]+[\.]?[\d]{1,3})/,
													    placeholder: '$0.00',
													    // columns: [{col: 0, className: "htCenter"},],
													    columns: [
																	   {
																			data: "Ship_To_State",
																			className: "htCenter",
																			readOnly: true
																		},
																		{
																			data: "150"
																		},
																		{
																			data: "200"
																		},
																		{
																			data: "250"
																		},
																		{
																			data: "300"
																		},
																		{
																			data: "350"
																		},
																		{
																			data: "400"
																		},
																		{
																			data: "450"
																		},
																		{
																			data: "500"
																		},
																		{
																			data: "550"
																		},
																		{
																			data: "600"
																		},
																		{
																			data: "650"
																		},
																		{
																			data: "700"
																		},
																		{
																			data: "750"
																		},
																		{
																			data: "800"
																		},
																		{
																			data: "850"
																		},
																		{
																			data: "900"
																		},
																		{
																			data: "950"
																		},
																		{
																			data: "1000"
																		},
																		{
																			data: "1050"
																		},
																		{
																			data: "1100"
																		},
																		{
																			data: "1150"
																		},
																		{
																			data: "1200"
																		},
																		{
																			data: "1250"
																		},
																		{
																			data: "1300"
																		},
																		{
																			data: "1350"
																		},
																		{
																			data: "1400"
																		},
																		{
																			data: "1450"
																		},
																		{
																			data: "1500"
																		}
																		
																	]
													  });
				  // if(!hot){setTimeout(4000);}
				  
				  var buttons = {
				    string: document.getElementById('export-string')
				  };
				  
				  var exportPlugin = hot.getPlugin('exportFile');
				  
				  buttons.string.addEventListener('click', function() {
				    var resultCSV = exportPlugin.exportAsString('csv');
				    console.log(resultCSV);
				    alert("CSV String = "+resultCSV);
				    var resultJSON = Papa.parse(resultCSV);
					console.log(resultJSON.meta.delimiter);
					
					alert("JSON of CSV String = "+JSON.stringify(resultJSON));
					console.log(resultJSON);
				  });
				  
				  
				  
				  function bindDumpButton() {
				      if (typeof Handsontable === "undefined") {
				        return;
				      }
				  
				      Handsontable.Dom.addEvent(document.body, 'click', function (e) {
				  
				        var element = e.target || e.srcElement;
				  
				        if (element.nodeName == "BUTTON" && element.name == 'dump') {
				          var name = element.getAttribute('data-dump');
				          var instance = element.getAttribute('data-instance');
				          var hot = window[instance];
				          console.log('data of ' + name, hot.getData());
				        }
				      });
				    }
				  bindDumpButton();

				});

				csv_upload = document.getElementById("csv_upload");
				csv_upload_txt = document.getElementById("csv_upload_txt");

				csv_upload.onchange = function(e){
					    var ext = csv_upload.value.match(/\.([^\.]+)$/)[1];
					    switch(ext)
					    {
					        case 'csv':
					        case 'xls':
					        case 'xlsx':
					            // alert('allowed');
					            break;
					        default:
					            alert('invalid file type');
					            this.value='';
					    }
					    csv_upload_txt.value = csv_upload.value.replace("fakepath","..");
			};
		</script>
	</body>
</html>