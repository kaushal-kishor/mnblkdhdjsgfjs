<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>Bulk Order</title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
		<link type="text/css" rel="stylesheet" href="https://docs.handsontable.com/pro/1.7.0/bower_components/handsontable-pro/dist/handsontable.full.min.css">
		<link rel="stylesheet" href="css/custom-style.css">
	</head>
	<body>
		<div class="container-fluid">
			<h6>&nbsp;</h6>
			<div class="row">
				<div class="col-md-2 col-sm-2 col-xs-2">
					<a class="disabled" style="font-size:20px; text-decoration:none !important;"><strong>Place Bulk Order</strong></a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<a href="index.php" class="text-green">Locations</a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<a href="product.html" class="text-green">Products</a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<a href="javascript:;" class="disabled">Shipping</a>	
				</div>
				<div class="col-md-1 col-sm-1 col-xs-1">
					<i class="fa fa-caret-right text-gray"></i>
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2">
					<a href="productAllocation.html" class=" text-gray">Product Allocation</a>	
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2 pull-right">
					<a href="#" class="btn btn-success pull-right">Clear Bulk Order</a>	
				</div>
			</div>
			<hr class="hr-full">
			<h4>&nbsp;</h4>
			
			<h2>Shipping</h2>
			<hr>
			
			 <div id="datasheet" class="hot handsontable htRowHeaders htColumnHeaders table-responsive1"></div> 
			  
			<h4>&nbsp;</h4>
			<div class="row">
				<div class="col-md-2 col-sm-2 col-xs-2">
					<button class="btn btn-primary" style="opacity:0.6;">Previous Page</button>		
				</div>
				<div class="col-md-2 col-sm-2 col-xs-2">
					<a href="#" class="btn btn-primary">Next Page&nbsp;&nbsp;<i class="fa fa-caret-right"></i></a>		
				</div>
			</div>

			<h2>&nbsp;</h2>

		</div>
		<h2>&nbsp;</h2>
		<script type="text/javascript" src="js/jquery-1.11.2.min.js"></script>
		<script type="text/javascript" src="js/bootstrap.js"></script>
		<script src="https://docs.handsontable.com/pro/1.7.0/bower_components/handsontable-pro/dist/handsontable.full.min.js"></script>
		<script type="text/javascript" src="js/papaparse.min.js"></script>
		<script type="text/javascript">
			document.addEventListener("DOMContentLoaded", function() {

			  var myData = [
							    ['AL','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['AK','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['AZ','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['AK','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['CA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['CO','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['CT','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['DE','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['FL','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['GA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['HI','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['ID','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['IL','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['IN','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['IO','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['KA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['KE','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['LO','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['ME','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MD','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MI','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MN','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MS','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MO','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['MT','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NE','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NV','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NH','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NJ','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NM','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NY','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NC','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['ND','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['OH','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['OK','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['OR','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['PA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['RI','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['SC','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['SD','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['TN','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['TX','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['UT','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['VE','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['VA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['WA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['DC','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['WV','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['WI','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['WY','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['J','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['C','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['BCVZB','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['A','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['A','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['M','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NSBKM','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NBEAA','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['M','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['PEICAB','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['NTXAE','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['A','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
								['H','','','','','','','','','','','','','','','','','','','','','','','','','','',''],
						    ];

			var hot = document.getElementById('datasheet');

			$("#datasheet").handsontable({
			  
				data: myData,
			    startRows: 29,
			    startCols: 65,
			    colHeaders: ['Ship To State ---  Weight Range','150','200','250','300','350','400','450','500','550','600','650','700','750','800','850','900','950','1000','1050','1100','1150','1200','1250','1300','1350','1400','1450','1500'],
			    rowHeaders: true,
			  });

			$('table').addClass('table1')
			  
			  var buttons = {
			    string: document.getElementById('export-string'),
			    stringRange: document.getElementById('export-string-range'),
			    blob: document.getElementById('export-blob'),
			    file: document.getElementById('export-file')
			  };
			  
			  var exportPlugin = hot.getPlugin('exportFile');
			  var resultTextarea = document.getElementById('result');
			  
			  buttons.string.addEventListener('click', function() {
			    resultTextarea.value = exportPlugin.exportAsString('csv');
			    console.log(resultTextarea.value);
			  });
			  
			  buttons.stringRange.addEventListener('click', function() {
			    resultTextarea.value = exportPlugin.exportAsString('csv', {
			      exportHiddenRows: true,     // default false, exports the hidden rows
			      exportHiddenColumns: true,  // default false, exports the hidden columns
			      columnHeaders: true,        // default false, exports the column headers
			      rowHeaders: true,           // default false, exports the row headers
			      columnDelimiter: ';',       // default ',', the data delimiter
			      range: [1, 1, 3, 3]         // data range in format: [startRow, endRow, startColumn, endColumn]
			    });
			    console.log(resultTextarea.value);
			  });
			  
			  buttons.blob.addEventListener('click', function() {
			    var blob = exportPlugin.exportAsBlob('csv');
			    resultTextarea.value = blob;
			    console.log(blob);
			  });
			  
			  buttons.file.addEventListener('click', function() {
			    exportPlugin.downloadFile('csv', {filename: 'MyFile'});
			  });
			  
			  
			  function bindDumpButton() {
			      if (typeof Handsontable === "undefined") {
			        return;
			      }
			  
			      Handsontable.Dom.addEvent(document.body, 'click', function (e) {
			  
			        var element = e.target || e.srcElement;
			  
			        if (element.nodeName == "BUTTON" && element.name == 'dump') {
			          var name = element.getAttribute('data-dump');
			          var instance = element.getAttribute('data-instance');
			          var hot = window[instance];
			          console.log('data of ' + name, hot.getData());
			        }
			      });
			    }
			  bindDumpButton();

			});

			csv_upload = document.getElementById("csv_upload");
			csv_upload_txt = document.getElementById("csv_upload_txt");

			csv_upload.onchange = function(e){
				    var ext = csv_upload.value.match(/\.([^\.]+)$/)[1];
				    switch(ext)
				    {
				        case 'csv':
				        case 'xls':
				        case 'xlsx':
				            // alert('allowed');
				            break;
				        default:
				            alert('invalid file type');
				            this.value='';
				    }
				    csv_upload_txt.value = csv_upload.value.replace("fakepath","..");
			};
		</script>
	</body>
</html>